<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Glider by Innovu</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Glider</h1>
      <h2 class="project-tagline">Simple, expressive, Promise-based API for interacting with Postgres</h2>
      <a href="https://github.com/Innovu/glider" class="btn">View on GitHub</a>
      <a href="https://github.com/Innovu/glider/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/Innovu/glider/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="glider---" class="anchor" href="#glider---" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>glider <a href="https://travis-ci.org/Innovu/glider"><img src="https://travis-ci.org/Innovu/glider.svg?branch=master" alt="Build Status"></a> <a href="https://coveralls.io/github/Innovu/glider?branch=master"><img src="https://coveralls.io/repos/github/Innovu/glider/badge.svg?branch=master" alt="Coverage Status"></a> <img src="https://img.shields.io/badge/node.js-%3E=0.12-brightgreen.svg" alt="node.js &gt;=0.12">
</h1>

<p>Simple, expressive, Promise-based API for interacting with Postgres built on <a href="https://github.com/brianc/node-postgres">node-postgres</a>. Supports node.js 0.12+.</p>

<h2>
<a id="install" class="anchor" href="#install" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Install</h2>

<pre><code>npm install --save glider
</code></pre>

<h2>
<a id="examples" class="anchor" href="#examples" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Examples</h2>

<h3>
<a id="select-queries" class="anchor" href="#select-queries" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>select queries</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> db <span class="pl-k">=</span> <span class="pl-en">glider</span>(<span class="pl-c1">CONNECTION_STRING</span>);
<span class="pl-smi">db</span>.<span class="pl-en">query</span>(<span class="pl-s"><span class="pl-pds">'</span>select 1::integer as number<span class="pl-pds">'</span></span>).<span class="pl-en">then</span>(<span class="pl-k">function</span>(<span class="pl-smi">result</span>) {
    <span class="pl-k">return</span> <span class="pl-smi">result</span>.<span class="pl-c1">rows</span>[<span class="pl-c1">0</span>].<span class="pl-smi">number</span> <span class="pl-k">===</span> <span class="pl-c1">1</span>; <span class="pl-c">// true</span>
});

<span class="pl-smi">db</span>.<span class="pl-c1">select</span>(<span class="pl-s"><span class="pl-pds">'</span>select 1::integer as number<span class="pl-pds">'</span></span>).<span class="pl-en">then</span>(<span class="pl-k">function</span>(<span class="pl-smi">result</span>) {
    <span class="pl-k">return</span> result[<span class="pl-c1">0</span>].<span class="pl-smi">number</span> <span class="pl-k">===</span> <span class="pl-c1">1</span>; <span class="pl-c">// true</span>
});

<span class="pl-smi">db</span>.<span class="pl-en">selectOne</span>(<span class="pl-s"><span class="pl-pds">'</span>select 1::integer as number<span class="pl-pds">'</span></span>).<span class="pl-en">then</span>(<span class="pl-k">function</span>(<span class="pl-smi">result</span>) {
    <span class="pl-k">return</span> <span class="pl-smi">result</span>.<span class="pl-smi">number</span> <span class="pl-k">===</span> <span class="pl-c1">1</span>; <span class="pl-c">// true</span>
});

<span class="pl-smi">db</span>.<span class="pl-en">selectValue</span>(<span class="pl-s"><span class="pl-pds">'</span>select 1::integer as number<span class="pl-pds">'</span></span>).<span class="pl-en">then</span>(<span class="pl-k">function</span>(<span class="pl-smi">result</span>) {
    <span class="pl-k">return</span> result <span class="pl-k">===</span> <span class="pl-c1">1</span>; <span class="pl-c">// true</span>
});</pre></div>

<h3>
<a id="insertupdatedelete" class="anchor" href="#insertupdatedelete" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>insert/update/delete</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> db <span class="pl-k">=</span> <span class="pl-en">glider</span>(<span class="pl-c1">CONNECTION_STRING</span>);
<span class="pl-smi">db</span>.<span class="pl-en">insert</span>(<span class="pl-s"><span class="pl-pds">'</span>insert into foo values (1, 2, 3), (3, 4, 5)<span class="pl-pds">'</span></span>).<span class="pl-en">then</span>(<span class="pl-k">function</span>(<span class="pl-smi">result</span>) {
    <span class="pl-k">return</span> <span class="pl-smi">result</span>.<span class="pl-smi">rowCount</span> <span class="pl-k">===</span> <span class="pl-c1">2</span> <span class="pl-k">&amp;&amp;</span> <span class="pl-smi">result</span>.<span class="pl-smi">command</span> <span class="pl-k">===</span> <span class="pl-s"><span class="pl-pds">'</span>INSERT<span class="pl-pds">'</span></span>; <span class="pl-c">// true</span>
});

<span class="pl-smi">db</span>.<span class="pl-en">update</span>(<span class="pl-s"><span class="pl-pds">'</span>update foo set value = 1 where id = 1<span class="pl-pds">'</span></span>).<span class="pl-en">then</span>(<span class="pl-k">function</span>(<span class="pl-smi">result</span>) {
    <span class="pl-k">return</span> <span class="pl-smi">result</span>.<span class="pl-smi">rowCount</span> <span class="pl-k">===</span> <span class="pl-c1">1</span> <span class="pl-k">&amp;&amp;</span> <span class="pl-smi">result</span>.<span class="pl-smi">command</span> <span class="pl-k">===</span> <span class="pl-s"><span class="pl-pds">'</span>UPDATE<span class="pl-pds">'</span></span>; <span class="pl-c">// true</span>
});

<span class="pl-smi">db</span>.<span class="pl-en">delete</span>(<span class="pl-s"><span class="pl-pds">'</span>delete from foo where id = 2<span class="pl-pds">'</span></span>).<span class="pl-en">then</span>(<span class="pl-k">function</span>(<span class="pl-smi">result</span>) {
    <span class="pl-k">return</span> <span class="pl-smi">result</span>.<span class="pl-smi">rowCount</span> <span class="pl-k">===</span> <span class="pl-c1">1</span> <span class="pl-k">&amp;&amp;</span> <span class="pl-smi">result</span>.<span class="pl-smi">command</span> <span class="pl-k">===</span> <span class="pl-s"><span class="pl-pds">'</span>DELETE<span class="pl-pds">'</span></span>; <span class="pl-c">// true</span>
});</pre></div>

<h3>
<a id="transactions" class="anchor" href="#transactions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>transactions</h3>

<p>If there's an error in any of the queries in a transaction, <code>glider</code> will automatically invoke a <code>ROLLBACK</code> and reject the current Promise with the database error.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> db <span class="pl-k">=</span> <span class="pl-en">glider</span>(<span class="pl-c1">CONNECTION_STRING</span>);
db
    .<span class="pl-en">begin</span>()
    .<span class="pl-en">query</span>(<span class="pl-s"><span class="pl-pds">'</span>create table foo (id serial, value integer)<span class="pl-pds">'</span></span>)
    .<span class="pl-en">query</span>(<span class="pl-s"><span class="pl-pds">'</span>insert into foo (value) values (1), (2), (3)<span class="pl-pds">'</span></span>)
    .<span class="pl-en">query</span>(<span class="pl-s"><span class="pl-pds">'</span>update foo set value = 99 where id = 1<span class="pl-pds">'</span></span>)
    .<span class="pl-en">query</span>(<span class="pl-s"><span class="pl-pds">'</span>delete from foo where id = 3<span class="pl-pds">'</span></span>)
    .<span class="pl-en">query</span>(<span class="pl-s"><span class="pl-pds">'</span>select * from foo<span class="pl-pds">'</span></span>)
    .<span class="pl-en">commit</span>()
    .<span class="pl-en">then</span>(<span class="pl-k">function</span>(<span class="pl-smi">results</span>) {
        <span class="pl-en">console</span>.<span class="pl-c1">log</span>(results[<span class="pl-c1">0</span>].<span class="pl-smi">command</span>);  <span class="pl-c">// CREATE</span>
        <span class="pl-en">console</span>.<span class="pl-c1">log</span>(results[<span class="pl-c1">1</span>].<span class="pl-smi">rowCount</span>); <span class="pl-c">// 3</span>
        <span class="pl-en">console</span>.<span class="pl-c1">log</span>(results[<span class="pl-c1">2</span>].<span class="pl-smi">rowCount</span>); <span class="pl-c">// 1</span>
        <span class="pl-en">console</span>.<span class="pl-c1">log</span>(results[<span class="pl-c1">3</span>].<span class="pl-smi">rowCount</span>); <span class="pl-c">// 1</span>
        <span class="pl-en">console</span>.<span class="pl-c1">log</span>(results[<span class="pl-c1">4</span>].<span class="pl-c1">rows</span>);     <span class="pl-c">// [ { id: 1, value: 99 }, { id: 2, value: 2 } ]</span>
    });</pre></div>

<p>or with <code>glider</code>'s specialized functions...</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> db <span class="pl-k">=</span> <span class="pl-en">glider</span>(<span class="pl-c1">CONNECTION_STRING</span>);
db
    .<span class="pl-en">begin</span>()
    .<span class="pl-en">query</span>(<span class="pl-s"><span class="pl-pds">'</span>create table foo (id serial, value integer)<span class="pl-pds">'</span></span>)
    .<span class="pl-en">insert</span>(<span class="pl-s"><span class="pl-pds">'</span>insert into foo (value) values (1), (2), (3)<span class="pl-pds">'</span></span>)
    .<span class="pl-en">update</span>(<span class="pl-s"><span class="pl-pds">'</span>update foo set value = 99 where id = 1<span class="pl-pds">'</span></span>)
    .<span class="pl-en">delete</span>(<span class="pl-s"><span class="pl-pds">'</span>delete from foo where id = 3<span class="pl-pds">'</span></span>)
    .<span class="pl-c1">select</span>(<span class="pl-s"><span class="pl-pds">'</span>select * from foo<span class="pl-pds">'</span></span>)
    .<span class="pl-en">selectOne</span>(<span class="pl-s"><span class="pl-pds">'</span>select value from foo where id = 1<span class="pl-pds">'</span></span>)
    .<span class="pl-en">selectValue</span>(<span class="pl-s"><span class="pl-pds">'</span>select value from foo where id = 1<span class="pl-pds">'</span></span>)
    .<span class="pl-en">commit</span>()
    .<span class="pl-en">then</span>(<span class="pl-k">function</span>(<span class="pl-smi">results</span>) {
        <span class="pl-en">console</span>.<span class="pl-c1">log</span>(results[<span class="pl-c1">0</span>].<span class="pl-smi">command</span>); <span class="pl-c">// CREATE</span>
        <span class="pl-en">console</span>.<span class="pl-c1">log</span>(results[<span class="pl-c1">1</span>]);         <span class="pl-c">// 3</span>
        <span class="pl-en">console</span>.<span class="pl-c1">log</span>(results[<span class="pl-c1">2</span>]);         <span class="pl-c">// 1</span>
        <span class="pl-en">console</span>.<span class="pl-c1">log</span>(results[<span class="pl-c1">3</span>]);         <span class="pl-c">// 1</span>
        <span class="pl-en">console</span>.<span class="pl-c1">log</span>(results[<span class="pl-c1">4</span>]);         <span class="pl-c">// [ { id: 1, value: 99 }, { id: 2, value: 2 } ]</span>
        <span class="pl-en">console</span>.<span class="pl-c1">log</span>(results[<span class="pl-c1">5</span>]);         <span class="pl-c">// { id: 1, value: 99 }</span>
        <span class="pl-en">console</span>.<span class="pl-c1">log</span>(results[<span class="pl-c1">6</span>]);         <span class="pl-c">// 99</span>
    });</pre></div>

<h2>
<a id="testing" class="anchor" href="#testing" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Testing</h2>

<h3>
<a id="prerequisites" class="anchor" href="#prerequisites" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Prerequisites</h3>

<ul>
<li><a href="https://www.vagrantup.com/">vagrant</a></li>
<li><a href="https://www.virtualbox.org/wiki/Downloads">VirtualBox</a></li>
</ul>

<h3>
<a id="run-tests-mocha--should" class="anchor" href="#run-tests-mocha--should" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Run tests (mocha + should)</h3>

<pre><code>npm test
</code></pre>

<h3>
<a id="generate-coverage-report-istanbul" class="anchor" href="#generate-coverage-report-istanbul" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Generate coverage report (istanbul)</h3>

<p>Reports are generated in the <code>./coverage</code> folder. An HTML-based report can be loaded into the browser from <code>./coverage/lcov-report/index.html</code>.</p>

<pre><code>npm run cover
</code></pre>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/Innovu/glider">Glider</a> is maintained by <a href="https://github.com/Innovu">Innovu</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
